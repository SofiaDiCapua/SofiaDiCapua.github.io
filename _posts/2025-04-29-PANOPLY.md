# From Mass to Molecule: A Hands‚ÄëOn Introduction to Proteomics with PANOPLY

> *A bridge between datasets and proteins for data‚Äëcurious people.*

---

## 1. Why read (and write) this post?

In recent years I have worked as a data analyst mostly related to the usage of Large Language Models (LLMs). As I enter more and more into biological data analysis, I want to diversify from the LLMs. So my curiosity led me to the proteomics field‚Äîa domain that, to my surprise, can benefit from LLMs too (but that will not be covered in this blog, if you feel curious about it check: [https://arxiv.org/html/2408.11363v1](https://arxiv.org/html/2408.11363v1), [https://arxiv.org/abs/2411.03743](https://arxiv.org/abs/2411.03743)).

This post is an excuse to investigate further into this topic and to be able to explain what I learned to a zero‚Äëbio‚Äëknowledge reader.

---

## 2. What is proteomics in plain English?

First of all, let's talk about the plain basics necessary to understand what proteomics is:

- **DNA = molecule that transports the genetic information necessary for the development, functioning, and reproduction of all known organisms. It can be understood as a cookbook** that lists every recipe for making proteins.
- **Proteins =** coded sequence of a DNA fraction that has 3D structure to be able to do a specific function. There's a huge variety ‚Äî they transport oxygen, relay signals, destroy invaders...

**Proteomics** is the art of **identifying, counting and studying those proteins** so we can figure out what's really happening inside a cell or organism: Which proteins appear? In what quantities? With what chemical tweaks?

### A brief analogy

Imagine a concert:

- The **set list** (DNA) says which songs should be played.
- **Proteomics** is sneaking in with a recorder to discover *which* songs are actually played (sequenced), *at what volume (which amount of a protein is going to be sequenced)*, and *with what improvised instruments (modifications in the protein sequence and hence in its structure and function)*.

### Why does it matter?

Proteomics is useful for studying proteins, their interactions, and how they contribute to various biological processes, including health and disease. It helps in understanding cell function, identifying disease biomarkers, and developing new therapies. For instance:

- **Precision medicine** ‚Äì pinpoint protein targets for tailored therapies.
- **Early diagnosis** ‚Äì a blood‚Äëprotein signature can sound the alarm before symptoms.
- **Biotechnology** ‚Äì engineer enzymes to produce drugs or biofuels.

---

## 3. The usual headaches

Proteomics isn‚Äôt just **big data**; it‚Äôs *wide, deep, and shape‚Äëshifting* data. Each of the \~20‚ÄØ000 human genes can generate tens of **proteoforms**‚Äîvariant forms produced by alternative splicing or post‚Äëtranslational tweaks‚Äîso the practical search space easily exceeds **one‚ÄØmillion distinct protein species**. Add the lack of universal protein identifiers and the painstaking job of translating raw counts into biological meaning, and you have a perfect storm of complexity.

| Challenge                | Why it hurts                                           |
| ------------------------ | ------------------------------------------------------ |
| **Huge data volumes**    | A single mass‚Äëspec run spits out gigabytes.            |
| **Fragmented pipelines** | 10‚Äì15 separate tools, each with its own format.        |
| **Reproducibility**      | Tiny version shifts break results.                     |
| **Steep learning curve** | Bioinformatics + statistics + biology + cloud ops = ü§Ø |

---

## 4. Meet PANOPLY

**PANOPLY** is an **open‚Äësource, cloud‚Äëbased platform** for automated and reproducible proteogenomic data analysis. It turns raw proteogenomic reads into interactive, shareable insights with minimal manual plumbing, using state‚Äëof‚Äëthe‚Äëart statistical and machine‚Äëlearning algorithms to transform multi‚Äëomic data from different samples into biologically meaningful and interpretable results.

Built on the Terra platform (Google Cloud) and written in Workflow Description Language (**WDL**), it lets you launch end‚Äëto‚Äëend analyses by cloning a workspace and pressing *Run*.

### What does PANOPLY bundle? (Figure¬†1A)
![Workflow](https://cdn.ncbi.nlm.nih.gov/pmc/blobs/493e/8791030/39f77dc94d58/nihms-1765107-f0001.jpg){: .mx-auto.d-block :}

- **Data quality & sanity checks**
  - Sample QC dashboards (profile plots, tumor‚Äëpurity scores, sample‚Äëswap detection).
- **Feature‚Äëlevel statistics**
  - Differential‚Äëabundance tests and association analyses.
  - Correlation of RNA expression or copy‚Äënumber variation to the proteome.
- **Biologically driven scoring**
  - **GSEA** and **single‚Äësample GSEA** for pathway enrichment.
  - **PTM‚ÄëSEA** for post‚Äëtranslational modification signatures.
- **Pattern discovery**
  - Outlier calling with **BlackSheep**.
  - Consensus clustering and multi‚Äëomic clustering via **non‚Äënegative matrix factorization (NMF)**.
- **Therapeutic clues**
  - **Connectivity Map (CMAP)** queries to nominate candidate drugs.
- **Story‚Äëready reports**
  - Each module spits out an **interactive HTML** summarizing key plots (heatmaps, volcano plots, correlation wheels). (Figure¬†1B)
  - All reports, data and parameters are versioned inside the workspace for reproducibility.

> üëâ **Full module list & docs:** see the PANOPLY wiki at [https://github.com/broadinstitute/PANOPLY/wiki](https://github.com/broadinstitute/PANOPLY/wiki).

Ready to dive into the world of proteomic data analysis? Jump to the next section to create a free Terra account and launch your first run!

## 5. Getting started (important info)

Luckily, PANOPLY v1.0 consists of various components, which I'm going to detail next, along with an extra point that might be critical for some of you who are considering using PANOPLY (you must pay).

1. **What PANOPLY requires**
   - To run PANOPLY, you need a Terra account; to create one follow the steps at [https://support.terra.bio/hc/en-us/articles/360034677651-Three-steps-to-get-started-in-Terra](https://support.terra.bio/hc/en-us/articles/360034677651-Three-steps-to-get-started-in-Terra). A Google account is required to create a Terra account.
   - Once you have an account, you need to create a cloud billing account and project ([here](https://support.terra.bio/hc/en-us/articles/360026182251-How-to-set-up-billing-in-Terra-GCP)). Here you will find step‚Äëby‚Äëstep instructions to set up **billing**, including a free‚Äëcredits program for new users to try out Terra with \$300 in Google Cloud credits.
2. All code and data are accessible online at GitHub ([https://github.com/broadinstitute/PANOPLY](https://github.com/broadinstitute/PANOPLY)) and Terra ([https://app.terra.bio/](https://app.terra.bio/)).
3. An interactive Jupyter notebook provides step‚Äëby‚Äëstep instructions for uploading data, identifying data types, specifying parameters, and setting up the PANOPLY workspace for analyzing a new dataset.
![Notebook]((https://raw.githubusercontent.com/broadinstitute/PANOPLY/dev/tutorial/images/notebook-tab-v1_4.png)){: .mx-auto.d-block :}
5. A tutorial ([https://github.com/broadinstitute/PANOPLY/wiki/PANOPLYTutorial](https://github.com/broadinstitute/PANOPLY/wiki/PANOPLYTutorial)) showing how to use the PANOPLY proteogenomic data‚Äëanalysis pipeline for a specific breast‚Äëcancer dataset.
6. A workspace ([https://app.terra.bio/#workspaces/broad-firecloud-cptac/PANOPLY\_Production\_Pipelines\_v1\_0](https://app.terra.bio/#workspaces/broad-firecloud-cptac/PANOPLY_Production_Pipelines_v1_0)) with a preconfigured unified workflow to automatically run all analysis tasks on proteomics (global proteome, phosphoproteome, acetylome, ubiquitylome), transcriptome and copy‚Äënumber data; and an additional workspace ([https://app.terra.bio/#workspaces/broad-firecloud-cptac/PANOPLY\_Production\_Modules\_v1\_0](https://app.terra.bio/#workspaces/broad-firecloud-cptac/PANOPLY_Production_Modules_v1_0)) that includes separate methods for each analysis component.

![Workspace]((https://raw.githubusercontent.com/broadinstitute/PANOPLY/dev/tutorial/images/clone-workspace.png)){: .mx-auto.d-block :}

---

## 6. Limitations and areas for improvement

While PANOPLY removes many hurdles, it is not a silver bullet. Keep these caveats in mind:

- **Pay‚Äëas‚Äëyou‚Äëgo cost model** ‚Äì Runs only on Terra/Google¬†Cloud; compute, storage, and egress on Google¬†Cloud are billed per use; long workflows or large cohorts can become expensive if you don‚Äôt monitor it.
- **Steep learning curve for WDL tweaks** ‚Äì Out‚Äëof‚Äëthe‚Äëbox pipelines run smoothly, but customizing them requires familiarity with WDL and the Cromwell execution engine.
- **Cancer‚Äëcentric defaults** ‚Äì Many modules and visualizations are optimized for CPTAC cancer datasets; non‚Äëcancer studies may need parameter tuning.
- **Documentation gaps** ‚Äì The wiki is expanding but some modules lag behind the code; be ready to read source or ping the Slack.

## 7. Lightning glossary

| Term                       | One‚Äëliner                                                                     |
| -------------------------- | ----------------------------------------------------------------------------- |
| **WDL**                    | Scripts describing *what* to run with *which inputs*.                         |
| **Mass spectrometry (MS)** | Ultra‚Äëprecise balance that weighs protein fragments.                          |
| **P‚Äëvalue**                | How likely it is that your data could have occurred under the null hypothesis |
| **Volcano plot**           | Graph marrying biological effect (fold‚Äëchange) and statistics (‚àílog‚ÇÅ‚ÇÄ‚ÄØp).     |

---

## 8. Take‚Äëhome message

Proteomics used to feel like a cliff for people coming from classical data analytics. Tools like **PANOPLY** flatten that slope: they automate the grunt work and document every step so we can focus on what matters‚Äî**interpreting the findings and telling compelling stories with our data**.

---

*Published: 29/04/2025, not updated as PANOPLY evolves.*

